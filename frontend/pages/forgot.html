<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Client Dashboard - FitBuddy</title>
<style>
body { font-family: Arial, sans-serif; background:#f5f5f5; padding:20px; }
h2 { color:#333; }
button { padding:10px 15px; border:none; border-radius:5px; background:#28a745; color:white; cursor:pointer; }
button:hover { background:#218838; }
div { margin-top:20px; padding:10px; background:#fff; border-radius:5px; box-shadow:0 0 5px rgba(0,0,0,0.1);}
</style>
</head>
<body>
<h2>Welcome, <span id="clientName"></span></h2>
<p>Role: <span id="clientRole"></span></p>
<button onclick="logout()">Logout</button>

<h3>Your Assigned Plans</h3>
<div id="assignedPlan">Loading...</div>

<script>
const token = localStorage.getItem('token');
const role = localStorage.getItem('role');
const name = localStorage.getItem('name');

if(!token || role !== 'client'){
  alert("Unauthorized! Login first.");
  window.location.href = "login.html";
}

document.getElementById('clientName').textContent = name;
document.getElementById('clientRole').textContent = role;

async function loadPlan(){
  try {
    const res = await fetch('http://127.0.0.1:5000/client/plan', {
      headers: { 'Authorization': `Bearer ${token}` }
    });
    const data = await res.json();
    document.getElementById('assignedPlan').textContent = JSON.stringify(data, null, 2);
  } catch(err){
    document.getElementById('assignedPlan').textContent = "Failed to load plan.";
  }
}
loadPlan();

function logout(){
  localStorage.clear();
  window.location.href = "login.html";
}
</script>
</body>
</html>
